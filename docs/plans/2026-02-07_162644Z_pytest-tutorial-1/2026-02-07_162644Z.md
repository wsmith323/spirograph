Plan-Id: 2026-02-07_162644Z-pytest-tutorial-1

# Pytest Tutorial Plan: Mirrored `tests/` Layout + `Makefile` Test Commands

## Summary
Set up a beginner-friendly pytest tutorial using real generator code, keep tests under a mirrored top-level `tests` package, and add a `Makefile` for convenient dev commands (instead of a package console script).

## Public API / Interface Changes
- No production API changes.
- Add test files/directories:
  - `/Users/warren/work/projects/spirograph/tests/__init__.py`
  - `/Users/warren/work/projects/spirograph/tests/spirograph/__init__.py`
  - `/Users/warren/work/projects/spirograph/tests/spirograph/generation/__init__.py`
  - `/Users/warren/work/projects/spirograph/tests/spirograph/generation/test_circular_generator.py`
- Add dev workflow file:
  - `/Users/warren/work/projects/spirograph/Makefile`
- Update dependency config:
  - `/Users/warren/work/projects/spirograph/pyproject.toml` to include `pytest` as a dev/test dependency.

## Directory Layout
```text
tests/
  __init__.py
  spirograph/
    __init__.py
    generation/
      __init__.py
      test_circular_generator.py
Makefile
```

## Implementation Steps

1. Create mirrored test package structure under `tests/spirograph/generation/`.
2. Add first tutorial test module for `CircularSpiroGenerator`.
3. Add `pytest` dependency in `pyproject.toml` (dev/test scope).
4. Add `Makefile` with minimal, explicit targets.
5. Run targeted test command, then full test command.

## `Makefile` Targets (Exact)
- `test`: run all tests quietly.
  - `python3 -m pytest -q`
- `test-generation`: run only generation tutorial module.
  - `python3 -m pytest tests/spirograph/generation/test_circular_generator.py -q`
- `test-verbose`: run all tests with verbose output.
  - `python3 -m pytest -v`

No formatting/lint targets included yet to keep this tutorial scope tight.

## Tutorial Test Cases (Exact)

1. `test_generate_returns_steps_plus_one_points`
- Valid request with `steps=120`.
- Assert `len(curve.points) == 121`.

2. `test_generate_sets_expected_laps_to_close_metadata`
- Request: `fixed_radius=105`, `rolling_radius=45`, `steps=180`.
- Assert `curve.metadata["laps_to_close"] == 3`.

3. `test_invalid_request_values_raise_value_error` (`@pytest.mark.parametrize`)
- Invalid cases:
  - `fixed_radius=0`
  - `rolling_radius=0`
  - `pen_distance=-1`
  - `steps=0`
- Assert `ValueError` on request construction.

4. `test_both_curve_types_produce_lap_spans` (`@pytest.mark.parametrize`)
- `SpiroType.HYPOTROCHOID`, `SpiroType.EPITROCHOID`.
- Assert at least one span has `kind is SpanKind.LAP`.

## Commands to Validate

1. Install pytest:
```bash
pip install pytest
```

2. Run tutorial test:
```bash
make test-generation
```

3. Run all tests:
```bash
make test
```

## Acceptance Criteria
- Mirrored `tests/spirograph/generation/` package exists.
- Tutorial test file contains the 4 specified tests.
- `Makefile` includes `test`, `test-generation`, `test-verbose`.
- `make test-generation` passes.
- No production behavior changed; no CLI test coverage added in this tutorial.

## Risks / Regression Potential
- Low risk (tests + dev tooling only).
- Main risk is future confusion if `Makefile` diverges from CI commands; mitigated by keeping commands explicit and minimal.

## Validation Scope
- Targeted tutorial module run and full test run.
- No manual CLI smoke checks required for this change since runtime code is untouched.

## Assumptions / Defaults
- You want package-style tests (`__init__.py` files) under `tests`.
- Keep tutorial intentionally simple and deterministic.
- `Makefile` is preferred over `just`, `tox`, and `nox` for current repo size and onboarding goals.
