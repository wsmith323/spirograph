Plan-Id: 2026-03-01_001417Z-tighten-post-run-console-output

# Tighten Post-Run Console Output (Concise, Non-Redundant)

## Summary

Reduce redundancy in the post-run console output by tightening three areas:

1. `Selected parameters` block becomes compact (2 lines).
2. `Curve analysis` becomes concise and high-signal (no long explanatory prose).
3. Bottom prompt-status line stays, but shorter.

This keeps useful signal while removing repeated information currently shown in
multiple places.

## Goal and Success Criteria

- Keep all important run context visible.
- Remove repeated facts across `Selected parameters`, `Curve analysis`,
  `Render preview`, and prompt status.
- Make the post-run block scannable in a few seconds.
- Preserve behavior and math; this is formatting/content reduction only.

Success means:
- Output is clearly shorter.
- No key diagnostic info is lost (closure complexity, density, render risk).
- Tests updated and passing.

## Scope

- `/Users/warren/work/projects/spirograph/spirograph/main.py`
- `/Users/warren/work/projects/spirograph/spirograph/console_ui/curve_analysis.py`
- `/Users/warren/work/projects/spirograph/tests/spirograph/console_ui/test_curve_analysis.py`
- Add/update tests for `main.py` output helpers only if test coverage exists for
  those helpers; otherwise keep this change validated through existing tests plus
  manual smoke checks.

## Out of Scope

- No changes to generation math.
- No changes to density/symmetry formulas.
- No changes to renderer behavior.
- No changes to command flow.

## Output Spec (Decision Complete)

## 1. `Selected parameters` (compact 2-line format)

Replace current multi-line block with:

- Header line: `Selected parameters:`
- Line 1 (geometry): `R=<int> r=<int> d=<int> type=<curve_type>`
- Line 2 (visual): `color=<mode summary> base=<hex> width=<float> speed=<int>`

Rules:
- `color=<mode summary>` uses existing mode formatting (`fixed`, `random_per_*`,
  `random_every_n_*` with `n` when applicable).
- Keep `base=<hex>` even in non-fixed mode for transparency.

## 2. `Curve analysis` (concise profile)

Replace verbose block with exactly these lines:

- `Curve analysis:`
- `  Closure: laps~<laps> spins~<spins> (<simple|moderate|complex>)`
- `  Perceived symmetry while rendering: <strong|moderate|weak>`
- `  Visual density: <Low|Medium|High|Very High> (footprint~<int>, inner~<int>)`
- `  Notes: <short existing driver summary>`

Remove from default output:
- Curve type sentence.
- Radius ratio explanatory sentence.
- Offset factor explanatory sentence.
- Separate footprint and inner-empty explanatory lines.

## 3. `Render preview` (render-specific only)

Keep only render-time info not already in analysis:

- `Render preview: steps=<int>, color=<mode>, interval=<int>`

Remove from render preview:
- `laps~...`
- `spins~...`

Keep warning behavior unchanged:
- Slow warning still triggers from existing thresholds.
- Warning text can stay as-is.

## 4. Prompt-status line (keep, shorter)

Keep line before prompt, but remove redundant fields.

New line format:

- `session: rand=<constraint>/<evolution> | locks=R:<...> r:<...> d:<...> | draw=width:<...>,speed:<...>`

Remove from this line:
- `curve=...`
- `color=...`
- `last_curve=...`

Reason:
- Curve and color are already in post-run block.
- `last_curve` adds low value once rerender command is known.

## Implementation Plan

1. Update `print_selected_parameters(...)` in
   `/Users/warren/work/projects/spirograph/spirograph/main.py` to emit the new
   2-line format.
2. Update `print_render_preview(...)` in
   `/Users/warren/work/projects/spirograph/spirograph/main.py` to drop
   `laps/spins` from preview output while keeping warning logic unchanged.
3. Update `print_prompt_status(...)` in
   `/Users/warren/work/projects/spirograph/spirograph/main.py` to the shorter
   `session:` format above.
4. Refactor `describe_curve(...)` output in
   `/Users/warren/work/projects/spirograph/spirograph/console_ui/curve_analysis.py`
   to the concise 5-line profile while reusing existing computed metrics and
   notes helpers.
5. Keep all calculations/helpers intact unless required purely to support the
   new string layout.
6. Update output assertions in
   `/Users/warren/work/projects/spirograph/tests/spirograph/console_ui/test_curve_analysis.py`
   to match new labels/line presence and removed text.
7. Run targeted tests:
   - `VIRTUAL_ENV=~/work/virtualenvs/spirograph ./scripts/test tests/spirograph/console_ui/test_curve_analysis.py -q`
8. Run full suite:
   - `VIRTUAL_ENV=~/work/virtualenvs/spirograph ./scripts/test -q`
9. Stage changed files with `git add ...`.
10. Run the `capture-last-plan` skill and stage the captured plan file.

## Public Interfaces / Types

- No public API/type changes.
- Internal console output text changes only.
- Existing function signatures remain unchanged.

## Tests and Scenarios

## Automated

- Update curve-analysis output smoke tests to assert:
  - `Curve analysis:`
  - `Closure: laps~... spins~... (...)`
  - `Perceived symmetry while rendering:`
  - `Visual density:`
  - `Notes:`
- Assert removed verbose phrases are absent:
  - `Radius ratio R/r`
  - `Offset factor d/r`
  - `Estimated footprint radius`
  - `Estimated inner empty radius`

## Manual smoke checks

- Generate one random curve (`Enter`) and verify compact post-run output shape.
- Generate one manual curve (`m`) and verify same concise output.
- Use non-fixed color mode and verify preview still shows correct
  `color + interval`.
- Confirm status line appears before prompt and uses shortened field set.
- Confirm slow warning still appears on high-step/high-complexity cases.

## Assumptions and Defaults

- Default display profile is concise; no verbosity toggle is added in this pass.
- Prompt-status line remains enabled by default (shortened, not removed).
- Notes remain a single short sentence using existing density-driver logic.
- No behavior/math changes are permitted in this pass.
